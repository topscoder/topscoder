#!/bin/bash

# See https://github.com/stefansundin/dotfiles/blob/master/setup-mac.sh
sudo xattr -d -r com.apple.quarantine /Applications
grep -nr paginator .
find . -name "*.css" | xargs -l10 grep ".ir"


# turn off notification bubble for System Preferences
defaults write com.apple.systempreferences AttentionPrefBundleIDs 0

# fix Home/End on full-size keyboards
mkdir ~/Library/KeyBindings/
vim ~/Library/KeyBindings/DefaultKeyBinding.dict
{
    "\UF729"  = "moveToBeginningOfLine:";                   /* Home */
    "\UF72B"  = "moveToEndOfLine:";                         /* End  */
    "$\UF729" = "moveToBeginningOfLineAndModifySelection:"; /* Shift + Home */
    "$\UF72B" = "moveToEndOfLineAndModifySelection:";       /* Shift + End  */
    /* Stop Mac from beeping when pressing Ctrl+Cmd+Down */
    /* https://github.com/atom/atom/issues/1669#issuecomment-135503562 */
    "^@\UF701" = "noop:";
    "^@\UF702" = "noop:";
    "^@\UF703" = "noop:";
}

# NSUserKeyEquivalents
# @    Command (Apple)  CMD
# ~    Option           OPT
# $    Shift            SHIFT
# ^    Control          CTRL

# this will print an error if there's a problem with Xcode
#xcodebuild -version
# install Xcode command line tools
#xcode-select --install
# accept Xcode EULA
sudo xcodebuild -license

# enable "Anywhere" option for Gatekeeper ("Allow apps downloaded from" in "Security & Privacy" settings)
sudo spctl --master-disable
# prevent Gatekeeper from re-enabling itself after 30 days ("Allow apps downloaded from" in "Security & Privacy")
sudo defaults write /Library/Preferences/com.apple.security GKAutoRearm -bool false
# disable “VLC.app is an application downloaded from the Internet. Are you sure you want to open it?”
sudo defaults delete com.apple.LaunchServices LSQuarantine
defaults write com.apple.LaunchServices LSQuarantine -bool false
sudo xattr -d -r com.apple.quarantine /Applications

# QuickLook plugins
brew cask install qlstephen qlmarkdown qlprettypatch qlimagesize qlcolorcode quicknfo betterzipql suspicious-package quicklook-json quicklook-csv
qlmanage -r
https://github.com/whomwah/qlstephen
## Note: Don't enable text selection in QuickLook as that will cause blank images to be shown in quicklook when going back and forth between images!
# sort Folders on top
cd /System/Library/CoreServices/Finder.app/Contents/Resources/English.lproj/
sudo plutil -convert xml1 InfoPlist.strings
sudo vim InfoPlist.strings
 <key>Folder</key>
 <string> Folder</string>
sudo plutil -convert binary1 InfoPlist.strings
## backspace to go up, delete key to move files to trash
defaults write com.apple.finder NSUserKeyEquivalents -dict-add 'Back' '\U232B'
defaults write com.apple.finder NSUserKeyEquivalents -dict-add 'Move to Trash' '\U007F'
## WARNING: DELETE KEY WILL NOW DELETE FILES AND FOLDERS IF YOU ARE ATTEMPTING TO RENAME THEM!! USE BACKSPACE!
defaults read com.apple.finder NSUserKeyEquivalents
killall Finder


# mute startup chime (does not work every time)
sudo nvram SystemAudioVolume=%80
sudo vim /etc/rc.common
 # mute startup chime
 nvram SystemAudioVolume=%80
# re-enable
sudo nvram -d SystemAudioVolume
# print setting
nvram -p | grep SystemAudioVolume